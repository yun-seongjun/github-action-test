#!/usr/bin/env sh

# í˜„ì¬ ë¸Œë Œì¹˜ì˜ ë„¤ì„ì„ branchì— ì €ì¥
branch="$(git rev-parse --abbrev-ref HEAD)"

ROOT="$(git rev-parse --show-toplevel)"

# CI í™˜ê²½ì—ì„œ í›… ìŠ¤í‚µ
if [ "$CI" = "true" ]; then
  echo "ğŸ”„ [Husky] pre-push skipped in CI environment"
  exit 0
fi

# branchê°€ main ì´ë¼ë©´ ë¬¸êµ¬ë¥¼ ë…¸ì¶œ ì‹œí‚¤ë©° ì¢…ë£Œ
if [ "$branch" = "main" ]; then
  echo "You can't commit directly to main branch"
  exit 1
fi

if [ "$branch" = "dev" ]; then
  echo "You can't commit directly to dev branch"
  exit 1
fi

if [ "$branch" = "staging" ]; then
  echo "You can't commit directly to staging branch"
  exit 1
fi

if [ "$branch" != "main" ] && [ "$branch" != "dev" ] && [ "$branch" != "staging" ]; then
  echo "ğŸ‘€  Start Inspection"
  #chmod +x $ROOT/ts-staged.sh || exit 1
  #bash "$ROOT/ts-staged.sh" || exit 1
  echo "ğŸ‘  End Inspection"
fi
